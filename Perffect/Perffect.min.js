window.Perffect||(window.Perffect=function(){function a(a,b,c,d){this.container=a,this.selector=b,this.gutter=c,this.elements=null,this.$arrangePointer=this.arrange.bind(this),this.$lastRAF=null,this.started=!1,d||this.rearrange()}function b(a){return window.setTimeout(a,33)}function c(a,c,d){var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||b;return e(function(){a.apply(c,d)})}function d(a){var b=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitRequestAnimationFrame||window.clearTimeout;return b(a)}return a.prototype.rearrange=function(){this.started||(Resizer.add(this.container,function(){this.$lastRAF&&d(this.$lastRAF),this.$lastRAF=c(this.rearrange,this)}.bind(this)),this.started=!0),this.refresh(),this.attachEvents(),this.layout()},a.prototype.attachEvents=function(){for(var a=0,b=this.elements.length,e=this.elements.item(a);b>a;a++,e=this.elements.item(a))Resizer.add(e,function(){this.$lastRAF&&d(this.$lastRAF),this.$lastRAF=c(this.$arrangePointer,this)}.bind(this))},a.prototype.arrange=function(){this.refresh(),this.layout()},a.prototype.refresh=function(){this.elements=this.container.querySelectorAll(this.selector),this.container.style.position="relative"},a.prototype.layout=function(){var a,b,c,d,e,f,g;if(this.elements.length){c=this.elements.item(0).offsetWidth,e=Math.trunc(this.container.offsetWidth/(c+this.gutter)),f=this.elements.length>e?e:this.elements.length,a=f*c+(f-1)*this.gutter,g=(this.container.offsetWidth-a)/2,d=new Array(e);for(var h=0;e>h;h++)d[h]=0;for(var h=0,i=0,b=0,j=this.elements.length,k=this.elements.item(h);j>h;++h,i=(i+1)%e,k=this.elements.item(h)){var l,m;l=i*c+g,i>0&&(l+=i*this.gutter),m=0|d[i],k.style.position="absolute",k.style.left=l+"px",k.style.top=m+"px",d[i]+=k.offsetHeight+this.gutter,d[i]>b&&(b=d[i])}b-=this.gutter,this.container.style.height=b+"px"}},a}());